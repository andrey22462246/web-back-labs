{% extends "base.html" %}

{% block lab %}–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 9{% endblock %}

{% block script %}
<script src="{{ url_for('static', filename='lab9/lab9.js') }}" defer></script>
<link rel="stylesheet" href="{{ url_for('static', filename='lab9/lab9.css') }}">
<style>
    .auth-panel {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        border: 2px solid var(--new-year-gold);
    }
    
    .auth-form {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .auth-input {
        padding: 10px 15px;
        border: 2px solid var(--new-year-green);
        border-radius: 25px;
        background: white;
        font-size: 1rem;
        min-width: 180px;
    }
    
    .auth-btn {
        padding: 10px 25px;
        border: none;
        border-radius: 25px;
        background: linear-gradient(45deg, #FF0000, #00AA00);
        color: white;
        font-weight: bold;
        cursor: pointer;
    }
    
    .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
        color: white;
    }
    
    .user-name {
        color: var(--new-year-gold);
        font-weight: bold;
    }
    
    .logout-btn {
        padding: 8px 15px;
        border: none;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        cursor: pointer;
    }
    
    .gift-box.locked {
        opacity: 0.6;
        cursor: not-allowed;
        position: relative;
    }
    
    .gift-box.locked:after {
        content: 'üîí';
        position: absolute;
        top: 5px;
        right: 5px;
        font-size: 1.5rem;
    }
    
    .locked-info {
        color: #ff6b6b;
        font-weight: bold;
        margin-left: 5px;
    }
    
    
    .btn-santa.hidden {
        display: none;
    }
    
    
    .test-accounts {
        margin-top: 10px;
        font-size: 0.9rem;
        color: var(--new-year-gold);
        background: rgba(0, 0, 0, 0.3);
        padding: 8px 12px;
        border-radius: 10px;
        border-left: 3px solid var(--new-year-green);
    }
    
    .test-accounts ul {
        margin: 5px 0 0 0;
        padding-left: 20px;
    }
    
    .test-accounts li {
        margin: 3px 0;
    }
</style>
{% endblock %}

{% block main %}
<div class="new-year-container">
    
    <div class="snowflakes" aria-hidden="true">
        {% for i in range(50) %}
        <div class="snowflake">‚ùÑ</div>
        {% endfor %}
    </div>
    
    
    <header class="new-year-header">
        <h1>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω–∏–µ –ü–æ–¥–∞—Ä–∫–∏ üéÑ</h1>
        <p class="subtitle">–ù–∞–π–¥–∏ 3 –ø–æ–¥–∞—Ä–∫–∞ –∏–∑ {{ available_count }}!</p>
    </header>
    
    
    <div class="auth-panel">
        {% if not authenticated %}
        <div class="auth-form" id="login-form">
            <input type="text" class="auth-input" id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
            <input type="password" class="auth-input" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            <button class="auth-btn" onclick="login()">üéÖ –í–æ–π—Ç–∏</button>
            <div style="color: var(--new-year-gold); margin-top: 10px;">
                üí° <span class="locked-info">1 –æ—Å–æ–±—ã–π –ø–æ–¥–∞—Ä–æ–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –≤—Ö–æ–¥–∞</span>
            </div>
        </div>
        
        <div class="test-accounts">
            <strong>–¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:</strong>
            <ul>
                <li><strong>user</strong> / <strong>123</strong></li>
                <li><strong>admin</strong> / <strong>admin</strong></li>
                <li><strong>–≥–æ—Å—Ç—å</strong> / <strong>–ø—Ä–∞–∑–¥–Ω–∏–∫</strong></li>
            </ul>
        </div>
        {% else %}
        <div class="user-info">
            <div>
                üéÖ –ü—Ä–∏–≤–µ—Ç, <span class="user-name">{{ username }}</span>!
                <div style="font-size: 0.9rem; margin-top: 5px;">
                    –¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ 10 –ø–æ–¥–∞—Ä–∫–æ–≤ –∏ –∫–Ω–æ–ø–∫–∞ –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞!
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
        </div>
        {% endif %}
    </div>
    
    
    <div class="info-panel">
        <div class="stats">
            <div class="stat-item">
                <span class="stat-icon">üéÅ</span>
                <div>
                    <div class="stat-label">–û—Ç–∫—Ä—ã—Ç–æ</div>
                    <div class="stat-value" id="opened-count">{{ opened_count }}/3</div>
                </div>
            </div>
            <div class="stat-item">
                <span class="stat-icon">üì¶</span>
                <div>
                    <div class="stat-label">–î–æ—Å—Ç—É–ø–Ω–æ</div>
                    <div class="stat-value" id="available-count">{{ available_count }}</div>
                </div>
            </div>
            <div class="stat-item">
                <span class="stat-icon">üéÖ</span>
                <div>
                    <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                    <div class="stat-value" id="status">–ì–æ—Ç–æ–≤!</div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
            <ul>
                <li>üéØ –ù–∞–π–¥–∏ –∏ –æ—Ç–∫—Ä–æ–π <strong>3 –ø–æ–¥–∞—Ä–∫–∞</strong></li>
                <li>{% if authenticated %}‚úÖ <strong>–í—Å–µ 10 –ø–æ–¥–∞—Ä–∫–æ–≤</strong> –¥–æ—Å—Ç—É–ø–Ω—ã{% else %}üîì <strong>9 –ø–æ–¥–∞—Ä–∫–æ–≤</strong> –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º{% endif %}</li>
                <li>{% if not authenticated %}üîí <strong>1 –æ—Å–æ–±—ã–π –ø–æ–¥–∞—Ä–æ–∫</strong> ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö{% endif %}</li>
                {% if authenticated %}
                <li>üéÖ –ù–∞–∂–º–∏ <strong>"–ü–æ–∑–≤–∞—Ç—å –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞"</strong> —á—Ç–æ–±—ã –ø–µ—Ä–µ–º–µ—à–∞—Ç—å –≤—Å–µ –ø–æ–¥–∞—Ä–∫–∏!</li>
                {% endif %}
                <li>üîÑ <strong>–ü–æ–∑–∏—Ü–∏–∏ –ø–æ–¥–∞—Ä–∫–æ–≤ —Å–ª—É—á–∞–π–Ω—ã</strong> –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏</li>
            </ul>
        </div>
    </div>
    
    
    <div class="gifts-field" id="gifts-container">
        
        <div class="tree-decoration">
            <div class="lights">
                <span class="light red"></span>
                <span class="light blue"></span>
                <span class="light green"></span>
                <span class="light yellow"></span>
                <span class="light purple"></span>
            </div>
        </div>
    </div>
    
    
    <div class="modal-overlay" id="congrat-modal" style="display: none;">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div class="congrat-header">
                <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
            </div>
            <div class="congrat-body">
                <div class="gift-image-container">
                    <img id="congrat-gift-image" src="" alt="–ü–æ–¥–∞—Ä–æ–∫">
                    <div class="gift-name" id="congrat-gift-name"></div>
                </div>
                <div class="congrat-text" id="congrat-text"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-continue" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>
    
    
    <div class="controls">
        
        {% if authenticated %}
        <button class="btn-santa" onclick="santaRefill()">
            üéÖ –ü–æ–∑–≤–∞—Ç—å –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞
        </button>
        {% else %}
        <button class="btn-santa hidden" onclick="santaRefill()" style="display: none;">
            üéÖ –ü–æ–∑–≤–∞—Ç—å –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞
        </button>
        {% endif %}
        
        <button class="btn-help" onclick="showHelp()">
            ‚ùì –ü–æ–º–æ—â—å
        </button>
    </div>
    
    
    <div class="error-message" id="error-message" style="display: none;"></div>
    <div class="success-message" id="success-message" style="display: none;"></div>
</div>
{% endblock %}