{% extends "base.html" %}

{% block lab %}Список пользователей{% endblock %}

{% block main %}
    <h1>Список пользователей</h1>
    
    <div style="margin-bottom: 20px;">
        <a href="/lab4/register">Добавить пользователя</a> |
        <a href="/lab4/logout" onclick="event.preventDefault(); document.getElementById('logout-form').submit();">Выйти</a>
        <form id="logout-form" action="/lab4/logout" method="post" style="display: none;">
            <button type="submit">Выйти</button>
        </form>
    </div>
    
    <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th>Имя</th>
                <th>Логин</th>
                <th>Пол</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.name }}</td>
                <td>{{ user.login }}</td>
                <td>{{ 'Мужской' if user.gender == 'male' else 'Женский' }}</td>
                <td>
                    {% if user.login == current_user %}
                        <form method="post" action="/lab4/edit-user" style="display: inline;">
                            <input type="hidden" name="login" value="{{ user.login }}">
                            <button type="submit">Редактировать</button>
                        </form>
                        <form method="post" action="/lab4/delete-user" style="display: inline;" 
                              onsubmit="return confirm('Вы уверены, что хотите удалить свой аккаунт?');">
                            <input type="hidden" name="login" value="{{ user.login }}">
                            <button type="submit" style="color: red;">Удалить</button>
                        </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}